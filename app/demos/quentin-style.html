<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>彩虹桥 — 宠物纪念</title>
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --bg: #0a0a0f;
  --gold: #FFD700;
  --gold-dim: rgba(255, 215, 0, 0.15);
  --gold-glow: rgba(255, 215, 0, 0.4);
  --white: #f0f0f0;
  --white-dim: rgba(240, 240, 240, 0.5);
  --font: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans SC", "PingFang SC", "Hiragino Sans GB", sans-serif;
}

html, body {
  width: 100%; height: 100%;
  overflow: hidden;
  background: var(--bg);
  color: var(--white);
  font-family: var(--font);
  cursor: none;
}

/* Custom cursor */
.cursor-dot {
  position: fixed;
  width: 8px; height: 8px;
  background: var(--gold);
  border-radius: 50%;
  pointer-events: none;
  z-index: 10000;
  transform: translate(-50%, -50%);
  transition: width 0.3s, height 0.3s, background 0.3s;
  mix-blend-mode: screen;
}
.cursor-ring {
  position: fixed;
  width: 40px; height: 40px;
  border: 1px solid var(--gold-glow);
  border-radius: 50%;
  pointer-events: none;
  z-index: 10000;
  transform: translate(-50%, -50%);
  transition: width 0.4s cubic-bezier(0.16, 1, 0.3, 1), height 0.4s cubic-bezier(0.16, 1, 0.3, 1), border-color 0.3s;
}
.cursor-ring.hovering {
  width: 64px; height: 64px;
  border-color: var(--gold);
}

/* Canvas layer */
#starCanvas {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  z-index: 0;
}

/* ===== REVEAL / LOADING ===== */
.reveal-overlay {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  z-index: 9000;
  background: var(--bg);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  pointer-events: all;
}
.reveal-overlay.done {
  pointer-events: none;
}

.reveal-title {
  font-size: clamp(3rem, 10vw, 8rem);
  font-weight: 200;
  letter-spacing: 0.3em;
  color: var(--white);
  overflow: hidden;
  display: flex;
  gap: 0.05em;
}
.reveal-title .char {
  display: inline-block;
  transform: translateY(120%);
  opacity: 0;
}

.reveal-subtitle {
  margin-top: 1.5rem;
  font-size: clamp(0.75rem, 2vw, 1rem);
  font-weight: 300;
  letter-spacing: 0.5em;
  color: var(--white-dim);
  opacity: 0;
  transform: translateY(20px);
}

.reveal-line {
  width: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--gold), transparent);
  margin-top: 2rem;
}

.reveal-version {
  position: absolute;
  bottom: 3rem;
  font-size: 0.7rem;
  letter-spacing: 0.4em;
  color: var(--white-dim);
  opacity: 0;
}

/* ===== MAIN CONTENT ===== */
.main-content {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  z-index: 1;
  opacity: 0;
  visibility: hidden;
}
.main-content.visible {
  opacity: 1;
  visibility: visible;
}

/* Navigation */
.nav {
  position: fixed;
  top: 0; left: 0; right: 0;
  z-index: 100;
  padding: 2rem 3rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  mix-blend-mode: difference;
}
.nav-logo {
  font-size: 0.85rem;
  font-weight: 300;
  letter-spacing: 0.35em;
  color: var(--white);
  text-transform: uppercase;
}
.nav-logo span {
  color: var(--gold);
}
.nav-links {
  display: flex;
  gap: 2.5rem;
  list-style: none;
}
.nav-links a {
  font-size: 0.7rem;
  font-weight: 300;
  letter-spacing: 0.3em;
  color: var(--white-dim);
  text-decoration: none;
  text-transform: uppercase;
  transition: color 0.3s;
  position: relative;
}
.nav-links a::after {
  content: '';
  position: absolute;
  bottom: -4px; left: 0;
  width: 0; height: 1px;
  background: var(--gold);
  transition: width 0.4s cubic-bezier(0.16, 1, 0.3, 1);
}
.nav-links a:hover { color: var(--white); }
.nav-links a:hover::after { width: 100%; }

/* 3D Gallery */
.gallery-container {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  perspective: 1200px;
  perspective-origin: 50% 50%;
  overflow: hidden;
}
.gallery-scene {
  position: absolute;
  top: 50%; left: 50%;
  width: 0; height: 0;
  transform-style: preserve-3d;
  transition: transform 0.1s linear;
}

/* Memorial Cards */
.memorial-card {
  position: absolute;
  width: 320px;
  padding: 2.5rem 2rem;
  background: rgba(255, 255, 255, 0.02);
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: 2px;
  backdrop-filter: blur(8px);
  transform-style: preserve-3d;
  cursor: none;
  transition: border-color 0.5s, background 0.5s, transform 0.6s cubic-bezier(0.16, 1, 0.3, 1);
  transform-origin: center center;
}
.memorial-card:hover {
  border-color: rgba(255, 215, 0, 0.2);
  background: rgba(255, 255, 255, 0.04);
}
.memorial-card .card-index {
  font-size: 0.6rem;
  letter-spacing: 0.4em;
  color: var(--gold-glow);
  margin-bottom: 1.5rem;
  font-weight: 300;
}
.memorial-card .card-name {
  font-size: 2rem;
  font-weight: 200;
  letter-spacing: 0.15em;
  margin-bottom: 0.5rem;
  color: var(--white);
}
.memorial-card .card-breed {
  font-size: 0.75rem;
  font-weight: 300;
  letter-spacing: 0.25em;
  color: var(--white-dim);
  margin-bottom: 2rem;
  text-transform: uppercase;
}
.memorial-card .card-divider {
  width: 30px;
  height: 1px;
  background: var(--gold);
  margin-bottom: 1.5rem;
  transition: width 0.5s cubic-bezier(0.16, 1, 0.3, 1);
}
.memorial-card:hover .card-divider {
  width: 60px;
}
.memorial-card .card-quote {
  font-size: 0.85rem;
  font-weight: 300;
  line-height: 1.8;
  color: rgba(255, 255, 255, 0.7);
  font-style: italic;
}
.memorial-card .card-star {
  margin-top: 1.5rem;
  font-size: 0.6rem;
  color: var(--gold-dim);
  letter-spacing: 0.2em;
}

/* Floating text elements - Quentin style */
.floating-text {
  position: fixed;
  font-weight: 200;
  letter-spacing: 0.3em;
  color: rgba(255, 255, 255, 0.03);
  font-size: clamp(4rem, 12vw, 10rem);
  white-space: nowrap;
  z-index: 0;
  pointer-events: none;
  user-select: none;
}
.floating-text.top { top: 10%; left: -5%; }
.floating-text.bottom { bottom: 8%; right: -5%; }

/* Footer */
.footer {
  position: fixed;
  bottom: 0; left: 0; right: 0;
  z-index: 100;
  padding: 2rem 3rem;
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
}
.footer-dedication {
  font-size: 0.7rem;
  font-weight: 300;
  letter-spacing: 0.2em;
  color: var(--gold-dim);
  transition: color 0.5s;
}
.footer-dedication:hover {
  color: var(--gold);
}
.footer-scroll-hint {
  font-size: 0.6rem;
  letter-spacing: 0.3em;
  color: var(--white-dim);
  text-transform: uppercase;
  opacity: 0.5;
  animation: pulse 2s ease-in-out infinite;
}
@keyframes pulse {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.7; }
}

/* Scroll indicator */
.scroll-indicator {
  position: fixed;
  right: 3rem;
  top: 50%;
  transform: translateY(-50%);
  z-index: 100;
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.scroll-dot {
  width: 4px; height: 4px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.15);
  transition: background 0.3s, transform 0.3s;
}
.scroll-dot.active {
  background: var(--gold);
  transform: scale(1.5);
}

/* Mobile */
@media (max-width: 768px) {
  .nav { padding: 1.5rem; }
  .nav-links { display: none; }
  .footer { padding: 1.5rem; }
  .memorial-card { width: 260px; padding: 2rem 1.5rem; }
  .memorial-card .card-name { font-size: 1.5rem; }
  .scroll-indicator { right: 1rem; }
  .cursor-dot, .cursor-ring { display: none; }
  html, body { cursor: auto; }
}
</style>
</head>
<body>

<!-- Custom Cursor -->
<div class="cursor-dot" id="cursorDot"></div>
<div class="cursor-ring" id="cursorRing"></div>

<!-- Star Canvas Background -->
<canvas id="starCanvas"></canvas>

<!-- Reveal Overlay -->
<div class="reveal-overlay" id="revealOverlay">
  <div class="reveal-title" id="revealTitle">
    <span class="char">彩</span>
    <span class="char">虹</span>
    <span class="char">桥</span>
  </div>
  <div class="reveal-subtitle" id="revealSubtitle">每一颗星，都是一次陪伴</div>
  <div class="reveal-line" id="revealLine"></div>
  <div class="reveal-version" id="revealVersion">v 1 . 0</div>
</div>

<!-- Main Content -->
<div class="main-content" id="mainContent">
  <!-- Nav -->
  <nav class="nav">
    <div class="nav-logo">彩虹<span>桥</span></div>
    <ul class="nav-links">
      <li><a href="#" data-hover>星 空</a></li>
      <li><a href="#" data-hover>纪 念</a></li>
      <li><a href="#" data-hover>关 于</a></li>
    </ul>
  </nav>

  <!-- Floating background text -->
  <div class="floating-text top" id="floatTop">RAINBOW BRIDGE</div>
  <div class="floating-text bottom" id="floatBottom">永远的陪伴</div>

  <!-- 3D Gallery -->
  <div class="gallery-container" id="galleryContainer">
    <div class="gallery-scene" id="galleryScene"></div>
  </div>

  <!-- Scroll indicator -->
  <div class="scroll-indicator" id="scrollIndicator">
    <div class="scroll-dot active" data-index="0"></div>
    <div class="scroll-dot" data-index="1"></div>
    <div class="scroll-dot" data-index="2"></div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <div class="footer-dedication">第一颗星，亮给小谦。</div>
    <div class="footer-scroll-hint">移动鼠标探索</div>
  </div>
</div>

<script>
// ===== DATA =====
const pets = [
  { name: '小谦', breed: '布偶猫', age: '21个月', quote: '你来过这个世界。这就够了。', index: '01' },
  { name: '年糕', breed: '橘猫', age: '5年8个月', quote: '窗台上的阳光还在，你却走远了。', index: '02' },
  { name: '豆豆', breed: '金毛', age: '12年3个月', quote: '十二年，你从未离开门口等我的位置。', index: '03' }
];

// ===== UTILS =====
const lerp = (a, b, t) => a + (b - a) * t;
const clamp = (v, min, max) => Math.min(Math.max(v, min), max);

// ===== MOUSE STATE =====
const mouse = { x: window.innerWidth / 2, y: window.innerHeight / 2, targetX: window.innerWidth / 2, targetY: window.innerHeight / 2, vx: 0, vy: 0, prevX: window.innerWidth / 2, prevY: window.innerHeight / 2 };

// ===== CUSTOM CURSOR =====
const cursorDot = document.getElementById('cursorDot');
const cursorRing = document.getElementById('cursorRing');
let dotX = mouse.x, dotY = mouse.y, ringX = mouse.x, ringY = mouse.y;

function updateCursor() {
  dotX = lerp(dotX, mouse.x, 0.35);
  dotY = lerp(dotY, mouse.y, 0.35);
  ringX = lerp(ringX, mouse.x, 0.12);
  ringY = lerp(ringY, mouse.y, 0.12);
  cursorDot.style.left = dotX + 'px';
  cursorDot.style.top = dotY + 'px';
  cursorRing.style.left = ringX + 'px';
  cursorRing.style.top = ringY + 'px';
}

// ===== STAR CANVAS =====
const canvas = document.getElementById('starCanvas');
const ctx = canvas.getContext('2d');
let W, H;
const stars = [];
const STAR_COUNT = 350;
const mouseInfluenceRadius = 180;

function resizeCanvas() {
  W = canvas.width = window.innerWidth;
  H = canvas.height = window.innerHeight;
}

class Star {
  constructor() { this.reset(); }
  reset() {
    this.x = Math.random() * W;
    this.y = Math.random() * H;
    this.baseX = this.x;
    this.baseY = this.y;
    this.size = Math.random() * 1.8 + 0.3;
    this.baseAlpha = Math.random() * 0.6 + 0.1;
    this.alpha = this.baseAlpha;
    this.twinkleSpeed = Math.random() * 0.02 + 0.005;
    this.twinkleOffset = Math.random() * Math.PI * 2;
    this.depth = Math.random(); // 0 = far, 1 = near
    this.color = Math.random() > 0.85 ? `rgba(255, 215, 0, ` : `rgba(240, 240, 255, `;
  }
  update(time) {
    // Twinkle
    this.alpha = this.baseAlpha + Math.sin(time * this.twinkleSpeed + this.twinkleOffset) * 0.15;
    
    // Mouse repulsion
    const dx = this.baseX - mouse.x;
    const dy = this.baseY - mouse.y;
    const dist = Math.sqrt(dx * dx + dy * dy);
    
    if (dist < mouseInfluenceRadius) {
      const force = (1 - dist / mouseInfluenceRadius) * 30 * (0.5 + this.depth * 0.5);
      const angle = Math.atan2(dy, dx);
      this.x = lerp(this.x, this.baseX + Math.cos(angle) * force, 0.08);
      this.y = lerp(this.y, this.baseY + Math.sin(angle) * force, 0.08);
      this.alpha = Math.min(1, this.alpha + (1 - dist / mouseInfluenceRadius) * 0.4);
    } else {
      this.x = lerp(this.x, this.baseX, 0.03);
      this.y = lerp(this.y, this.baseY, 0.03);
    }
  }
  draw() {
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
    ctx.fillStyle = this.color + this.alpha + ')';
    ctx.fill();
    
    // Glow for brighter stars
    if (this.size > 1.2 && this.alpha > 0.4) {
      ctx.beginPath();
      ctx.arc(this.x, this.y, this.size * 3, 0, Math.PI * 2);
      ctx.fillStyle = this.color + (this.alpha * 0.1) + ')';
      ctx.fill();
    }
  }
}

function initStars() {
  stars.length = 0;
  for (let i = 0; i < STAR_COUNT; i++) stars.push(new Star());
}

// ===== MOUSE TRAIL (fluid-like) =====
const trail = [];
const TRAIL_LENGTH = 25;

class TrailPoint {
  constructor(x, y) {
    this.x = x; this.y = y;
    this.life = 1;
    this.decay = 0.025;
  }
  update() { this.life -= this.decay; }
}

function drawTrail() {
  if (trail.length < 2) return;
  
  for (let i = trail.length - 1; i >= 0; i--) {
    trail[i].update();
    if (trail[i].life <= 0) { trail.splice(i, 1); continue; }
  }
  
  if (trail.length < 2) return;
  
  ctx.beginPath();
  ctx.moveTo(trail[0].x, trail[0].y);
  
  for (let i = 1; i < trail.length - 1; i++) {
    const xc = (trail[i].x + trail[i + 1].x) / 2;
    const yc = (trail[i].y + trail[i + 1].y) / 2;
    ctx.quadraticCurveTo(trail[i].x, trail[i].y, xc, yc);
  }
  
  ctx.strokeStyle = `rgba(255, 215, 0, 0.08)`;
  ctx.lineWidth = 1;
  ctx.stroke();
  
  // Draw glow points
  for (let i = 0; i < trail.length; i++) {
    const p = trail[i];
    const r = p.life * 3;
    const gradient = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, r);
    gradient.addColorStop(0, `rgba(255, 215, 0, ${p.life * 0.3})`);
    gradient.addColorStop(1, `rgba(255, 215, 0, 0)`);
    ctx.beginPath();
    ctx.arc(p.x, p.y, r, 0, Math.PI * 2);
    ctx.fillStyle = gradient;
    ctx.fill();
  }
}

// Subtle nebula background
function drawNebula() {
  const g1 = ctx.createRadialGradient(W * 0.2, H * 0.3, 0, W * 0.2, H * 0.3, W * 0.4);
  g1.addColorStop(0, 'rgba(60, 20, 80, 0.015)');
  g1.addColorStop(1, 'rgba(0, 0, 0, 0)');
  ctx.fillStyle = g1;
  ctx.fillRect(0, 0, W, H);
  
  const g2 = ctx.createRadialGradient(W * 0.8, H * 0.7, 0, W * 0.8, H * 0.7, W * 0.35);
  g2.addColorStop(0, 'rgba(20, 40, 80, 0.012)');
  g2.addColorStop(1, 'rgba(0, 0, 0, 0)');
  ctx.fillStyle = g2;
  ctx.fillRect(0, 0, W, H);
}

// Mouse glow at cursor position
function drawMouseGlow() {
  const speed = Math.sqrt(mouse.vx * mouse.vx + mouse.vy * mouse.vy);
  const glowSize = clamp(40 + speed * 0.5, 40, 120);
  const glowAlpha = clamp(0.04 + speed * 0.001, 0.04, 0.12);
  
  const gradient = ctx.createRadialGradient(mouse.x, mouse.y, 0, mouse.x, mouse.y, glowSize);
  gradient.addColorStop(0, `rgba(255, 215, 0, ${glowAlpha})`);
  gradient.addColorStop(0.5, `rgba(255, 215, 0, ${glowAlpha * 0.3})`);
  gradient.addColorStop(1, `rgba(255, 215, 0, 0)`);
  ctx.beginPath();
  ctx.arc(mouse.x, mouse.y, glowSize, 0, Math.PI * 2);
  ctx.fillStyle = gradient;
  ctx.fill();
}

// ===== 3D GALLERY =====
const galleryScene = document.getElementById('galleryScene');
const galleryContainer = document.getElementById('galleryContainer');
let cards = [];
let galleryRotX = 0, galleryRotY = 0;
let targetRotX = 0, targetRotY = 0;

function createCards() {
  const positions = [
    { x: -450, y: -30, z: -80, rotY: 6 },
    { x: 20, y: 40, z: -300, rotY: -2 },
    { x: 420, y: -60, z: -30, rotY: -7 }
  ];
  
  pets.forEach((pet, i) => {
    const card = document.createElement('div');
    card.className = 'memorial-card';
    card.innerHTML = `
      <div class="card-index">NO. ${pet.index} — ${pet.age}</div>
      <div class="card-name">${pet.name}</div>
      <div class="card-breed">${pet.breed}</div>
      <div class="card-divider"></div>
      <div class="card-quote">"${pet.quote}"</div>
      <div class="card-star">★</div>
    `;
    
    const pos = positions[i];
    card.style.transform = `translate3d(${pos.x}px, ${pos.y}px, ${pos.z}px) rotateY(${pos.rotY}deg)`;
    card.style.opacity = '0';
    
    card.addEventListener('mouseenter', () => cursorRing.classList.add('hovering'));
    card.addEventListener('mouseleave', () => cursorRing.classList.remove('hovering'));
    
    galleryScene.appendChild(card);
    cards.push({ el: card, pos, baseX: pos.x, baseY: pos.y, baseZ: pos.z });
  });
}

function updateGallery() {
  const cx = (mouse.x / W - 0.5) * 2;
  const cy = (mouse.y / H - 0.5) * 2;
  
  targetRotY = cx * 8;
  targetRotX = -cy * 5;
  
  galleryRotX = lerp(galleryRotX, targetRotX, 0.04);
  galleryRotY = lerp(galleryRotY, targetRotY, 0.04);
  
  galleryScene.style.transform = `rotateX(${galleryRotX}deg) rotateY(${galleryRotY}deg)`;
  
  // Parallax on individual cards
  cards.forEach((card, i) => {
    const depth = 1 + (i * 0.15);
    const px = card.baseX + cx * 15 * depth;
    const py = card.baseY + cy * 10 * depth;
    card.el.style.transform = `translate3d(${px}px, ${py}px, ${card.baseZ}px) rotateY(${card.pos.rotY + galleryRotY * 0.1}deg)`;
  });
}

// ===== FLOATING TEXT PARALLAX =====
const floatTop = document.getElementById('floatTop');
const floatBottom = document.getElementById('floatBottom');

function updateFloatingText() {
  const cx = (mouse.x / W - 0.5);
  const cy = (mouse.y / H - 0.5);
  floatTop.style.transform = `translate(${cx * -30}px, ${cy * -15}px)`;
  floatBottom.style.transform = `translate(${cx * 20}px, ${cy * 10}px)`;
}

// ===== REVEAL ANIMATION =====
function playReveal() {
  const chars = document.querySelectorAll('.reveal-title .char');
  const subtitle = document.getElementById('revealSubtitle');
  const line = document.getElementById('revealLine');
  const version = document.getElementById('revealVersion');
  const overlay = document.getElementById('revealOverlay');
  const mainContent = document.getElementById('mainContent');
  
  // Phase 1: Characters slide up one by one
  chars.forEach((char, i) => {
    setTimeout(() => {
      char.style.transition = `transform 0.9s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.9s ease`;
      char.style.transform = 'translateY(0)';
      char.style.opacity = '1';
    }, 400 + i * 200);
  });
  
  // Phase 2: Subtitle fades in
  setTimeout(() => {
    subtitle.style.transition = 'opacity 1s ease, transform 1s cubic-bezier(0.16, 1, 0.3, 1)';
    subtitle.style.opacity = '1';
    subtitle.style.transform = 'translateY(0)';
  }, 1200);
  
  // Phase 3: Line expands
  setTimeout(() => {
    line.style.transition = 'width 1.2s cubic-bezier(0.16, 1, 0.3, 1)';
    line.style.width = '120px';
  }, 1600);
  
  // Phase 4: Version
  setTimeout(() => {
    version.style.transition = 'opacity 0.8s ease';
    version.style.opacity = '1';
  }, 1800);
  
  // Phase 5: Overlay fades out, main content appears
  setTimeout(() => {
    overlay.style.transition = 'opacity 1.2s cubic-bezier(0.4, 0, 0.2, 1)';
    overlay.style.opacity = '0';
    overlay.classList.add('done');
    
    mainContent.classList.add('visible');
    mainContent.style.transition = 'opacity 1.5s ease';
    
    // Stagger card reveals
    cards.forEach((card, i) => {
      setTimeout(() => {
        card.el.style.transition = 'opacity 1s ease, border-color 0.5s, background 0.5s, transform 0.6s cubic-bezier(0.16, 1, 0.3, 1)';
        card.el.style.opacity = '1';
      }, i * 250);
    });
  }, 3000);
  
  // Remove overlay from DOM
  setTimeout(() => {
    overlay.style.display = 'none';
  }, 4500);
}

// ===== SCROLL DOTS =====
const scrollDots = document.querySelectorAll('.scroll-dot');
let activeCard = 0;

function updateScrollDots() {
  // Determine closest card based on mouse position
  const cx = mouse.x / W;
  if (cx < 0.33) activeCard = 0;
  else if (cx < 0.66) activeCard = 1;
  else activeCard = 2;
  
  scrollDots.forEach((dot, i) => {
    dot.classList.toggle('active', i === activeCard);
  });
}

// ===== MAIN ANIMATION LOOP =====
let time = 0;

function animate() {
  time += 1;
  
  // Update mouse velocity
  mouse.vx = mouse.x - mouse.prevX;
  mouse.vy = mouse.y - mouse.prevY;
  mouse.prevX = mouse.x;
  mouse.prevY = mouse.y;
  
  // Smooth mouse
  mouse.x = lerp(mouse.x, mouse.targetX, 0.15);
  mouse.y = lerp(mouse.y, mouse.targetY, 0.15);
  
  // Canvas
  ctx.clearRect(0, 0, W, H);
  
  // Draw nebula
  drawNebula();
  
  // Draw stars
  for (let i = 0; i < stars.length; i++) {
    stars[i].update(time);
    stars[i].draw();
  }
  
  // Draw trail & glow
  drawTrail();
  drawMouseGlow();
  
  // Update cursor
  updateCursor();
  
  // Update gallery
  updateGallery();
  
  // Update floating text
  updateFloatingText();
  
  // Update scroll dots
  updateScrollDots();
  
  requestAnimationFrame(animate);
}

// ===== EVENT LISTENERS =====
function onMouseMove(e) {
  mouse.targetX = e.clientX;
  mouse.targetY = e.clientY;
  
  // Add trail point
  const speed = Math.sqrt(mouse.vx * mouse.vx + mouse.vy * mouse.vy);
  if (speed > 1) {
    trail.push(new TrailPoint(e.clientX, e.clientY));
    if (trail.length > TRAIL_LENGTH) trail.shift();
  }
}

function onTouchMove(e) {
  e.preventDefault();
  const touch = e.touches[0];
  mouse.targetX = touch.clientX;
  mouse.targetY = touch.clientY;
  
  trail.push(new TrailPoint(touch.clientX, touch.clientY));
  if (trail.length > TRAIL_LENGTH) trail.shift();
}

window.addEventListener('mousemove', onMouseMove);
window.addEventListener('touchmove', onTouchMove, { passive: false });
window.addEventListener('touchstart', (e) => {
  const touch = e.touches[0];
  mouse.targetX = touch.clientX;
  mouse.targetY = touch.clientY;
  mouse.x = touch.clientX;
  mouse.y = touch.clientY;
});

window.addEventListener('resize', () => {
  resizeCanvas();
  stars.forEach(s => {
    s.baseX = Math.random() * W;
    s.baseY = Math.random() * H;
    s.x = s.baseX;
    s.y = s.baseY;
  });
});

// ===== INIT =====
resizeCanvas();
initStars();
createCards();
animate();

// Start reveal after a brief pause
setTimeout(playReveal, 300);
</script>
</body>
</html>
